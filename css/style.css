/* Apply Inter font globally */
body {
    font-family: 'Inter', sans-serif;
}

/* Custom scrollbar for sidebar (optional) */
.sidebar-scroll::-webkit-scrollbar { width: 6px; }
.sidebar-scroll::-webkit-scrollbar-track { background: transparent; }
.sidebar-scroll::-webkit-scrollbar-thumb { background-color: rgba(156, 163, 175, 0.5); border-radius: 3px; }
.dark .sidebar-scroll::-webkit-scrollbar-thumb { background-color: rgba(107, 114, 128, 0.5); }

/* === Visualization Bar Styling === */
.vis-bar {
    display: inline-block;
    background-color: #3b82f6; /* blue-500 */
    margin: 0 1px;
    width: 15px;
    vertical-align: bottom;
    transition: height 0.3s ease-in-out, background-color 0.3s ease-in-out, opacity 0.3s ease-in-out, border 0.1s ease-in-out, transform 0.3s ease-in-out;
    border-radius: 4px 4px 0 0;
    position: relative;
    text-align: center;
    color: white;
    font-size: 10px;
    line-height: 1;
    border: 1px solid transparent; /* Base border */
}
.dark .vis-bar { background-color: #60a5fa; /* blue-400 */ }

/* General comparison/mid-point highlight */
.vis-bar.comparing {
    background-color: #facc15; /* yellow-400 */
    border-color: #eab308; /* yellow-500 */
}
.dark .vis-bar.comparing {
    background-color: #fde047; /* yellow-300 */
    border-color: #facc15; /* yellow-400 */
}
/* Swapping highlight (Sorting) */
.vis-bar.swapping {
    background-color: #f87171; /* red-400 */
    border-color: #ef4444; /* red-500 */
}
.dark .vis-bar.swapping {
    background-color: #ef4444; /* red-500 */
    border-color: #dc2626; /* red-600 */
}
/* Sorted element highlight (General Sorting) */
 .vis-bar.sorted-pass { /* Used in Bubble sort pass */
    background-color: #a3e635; /* lime-400 */
 }
 .dark .vis-bar.sorted-pass { background-color: #bef264; /* lime-300 */ }
 .vis-bar.sorted-final { /* Final sorted state */
    background-color: #4ade80; /* green-400 */
 }
 .dark .vis-bar.sorted-final { background-color: #86efac; /* green-300 */ }

/* Found element highlight (Searching) */
.vis-bar.found {
    background-color: #fb923c; /* orange-400 */
    border: 2px solid #f97316; /* orange-500 */
}
.dark .vis-bar.found {
    background-color: #fdba74; /* orange-300 */
     border: 2px solid #ea580c; /* orange-600 */
}
 /* Dimmed/Checked/Out-of-range element */
.vis-bar.checked, .vis-bar.out-of-range, .vis-bar.outside-partition, .vis-bar.outside-heap-range, .vis-bar.outside-merge-range { opacity: 0.4; }
/* Highlight for the current search/partition range */
.vis-bar.in-range, .vis-bar.partition-range, .vis-bar.heap-range, .vis-bar.merge-range { /* No specific style, relies on dimming */ }

/* == Selection Sort Specific Styles == */
.vis-bar.current-outer { border-bottom: 3px solid #a855f7; } /* purple-500 */
.dark .vis-bar.current-outer { border-bottom-color: #c084fc; } /* purple-400 */
.vis-bar.minimum { background-color: #ec4899; border-color: #db2777; } /* pink-500/600 */
.dark .vis-bar.minimum { background-color: #f9a8d4; border-color: #ec4899; } /* pink-300/500 */

/* == Insertion Sort Specific Styles == */
.vis-bar.current-insertion { border: 2px solid #f43f5e; transform: translateY(-10px); } /* rose-500 */
.dark .vis-bar.current-insertion { border-color: #fb7185; } /* rose-400 */
.vis-bar.shifting { opacity: 0.7; background-color: #6366f1; } /* indigo-500 */
 .dark .vis-bar.shifting { background-color: #818cf8; } /* indigo-400 */

/* == Quick Sort Specific Styles == */
.vis-bar.pivot { border: 2px dashed #f43f5e; } /* rose-500 dashed border */
.dark .vis-bar.pivot { border-color: #fb7185; } /* rose-400 */
.vis-bar.partition-i::before { content: 'i'; position: absolute; top: -18px; left: 50%; transform: translateX(-50%); font-size: 12px; font-weight: bold; color: #a855f7; } /* purple-500 */
 .dark .vis-bar.partition-i::before { color: #c084fc; } /* purple-400 */
.vis-bar.partition-j::after { content: 'j'; position: absolute; bottom: -18px; left: 50%; transform: translateX(-50%); font-size: 12px; font-weight: bold; color: #22c55e; } /* green-500 */
.dark .vis-bar.partition-j::after { color: #4ade80; } /* green-400 */
.vis-bar.sorted-partition { background-color: #22d3ee; } /* cyan-400 */
.dark .vis-bar.sorted-partition { background-color: #67e8f9; } /* cyan-300 */

/* == Merge Sort Specific Styles == */
.vis-bar.placing-merge { background-color: #6366f1; border-color: #4f46e5; } /* indigo-500/600 */
 .dark .vis-bar.placing-merge { background-color: #818cf8; border-color: #6366f1; } /* indigo-400/500 */

/* == Heap Sort Specific Styles == */
.vis-bar.heapify-node { border: 2px solid #fbbf24; /* amber-400 */ }
.dark .vis-bar.heapify-node { border-color: #fcd34d; /* amber-300 */ }
.vis-bar.heapify-largest { background-color: #f87171; /* red-400 */ }
.dark .vis-bar.heapify-largest { background-color: #ef4444; /* red-500 */ }

/* === Counting Sort Specific Styles === */
.vis-bar.reading { background-color: #fb923c; } /* orange-400 */
.dark .vis-bar.reading { background-color: #fdba74; } /* orange-300 */
.vis-bar.writing { background-color: #a3e635; } /* lime-400 */
.dark .vis-bar.writing { background-color: #bef264; } /* lime-300 */

.count-array-vis, .output-array-vis {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    margin-top: 10px;
    padding: 8px;
    border: 1px solid #e5e7eb; /* gray-200 */
    border-radius: 6px;
    background-color: #f9fafb; /* gray-50 */
    min-height: 40px;
    align-items: center;
    position: relative; /* For label */
    padding-top: 14px; /* Space for label */
    margin-bottom: 20px; /* Space for indices */
}
.dark .count-array-vis, .dark .output-array-vis {
    border-color: #4b5563; /* gray-600 */
    background-color: #374151; /* gray-700 */
}
.count-array-vis::before, .output-array-vis::before {
    content: attr(data-label);
    position: absolute;
    top: -10px;
    left: 5px;
    font-size: 0.75rem; /* 12px */
    font-weight: 500;
    color: #6b7280; /* gray-500 */
    background-color: #f9fafb; /* gray-50 */
    padding: 0 4px;
}
.dark .count-array-vis::before, .dark .output-array-vis::before {
    color: #d1d5db; /* gray-300 */
    background-color: #374151; /* gray-700 */
}

.count-cell, .output-cell {
    min-width: 25px;
    height: 25px;
    border: 1px solid #d1d5db; /* gray-300 */
    border-radius: 4px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 11px;
    background-color: #fff; /* white */
    transition: background-color 0.3s ease-in-out, border-color 0.3s ease-in-out, transform 0.2s ease-in-out;
    position: relative; /* For index label */
    color: #1f2937; /* gray-800 */
}
.dark .count-cell, .dark .output-cell {
    border-color: #6b7280; /* gray-500 */
    background-color: #4b5563; /* gray-600 */
    color: #f3f4f6; /* gray-100 */
}
.count-cell::after, .output-cell::after {
    content: attr(data-index);
    position: absolute;
    bottom: -14px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 9px;
    color: #9ca3af; /* gray-400 */
}
.dark .count-cell::after, .dark .output-cell::after {
    color: #6b7280; /* gray-500 */
}

.count-cell.highlight-read, .output-cell.highlight-read {
    border-color: #fb923c; /* orange-400 */
    transform: scale(1.1);
}
.count-cell.highlight-write, .output-cell.highlight-write {
    background-color: #a3e635; /* lime-400 */
    border-color: #84cc16; /* lime-500 */
    transform: scale(1.1);
}
.dark .count-cell.highlight-write, .dark .output-cell.highlight-write {
     background-color: #bef264; /* lime-300 */
     border-color: #a3e635; /* lime-400 */
}
.output-cell.empty {
    background-color: #e5e7eb; /* gray-200 */
    color: #9ca3af; /* gray-400 */
}
.dark .output-cell.empty {
    background-color: #4b5563; /* gray-600 */
    color: #6b7280; /* gray-500 */
}


/* === Tree Visualization Specific Styles === */
.tree-visualization-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    padding: 15px;
    border: 1px solid #e5e7eb; /* gray-200 */
    border-radius: 6px;
    background-color: #f9fafb; /* gray-50 */
    margin-bottom: 10px;
    width: 100%;
    box-sizing: border-box;
}
.dark .tree-visualization-container {
    border-color: #4b5563; /* gray-600 */
    background-color: #374151; /* gray-700 */
}

/* Styles for Tree Traversal Type Selector */
.traversal-type-selector, .bfs-dfs-type-selector { /* Combined */
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 15px;
    margin-bottom: 10px;
    padding: 5px;
    font-size: 0.875rem;
}
.traversal-type-selector label, .bfs-dfs-type-selector label { /* Combined */
    display: flex;
    align-items: center;
    gap: 5px;
    cursor: pointer;
    color: #374151; /* gray-700 */
}
.dark .traversal-type-selector label, .dark .bfs-dfs-type-selector label { /* Combined */
    color: #d1d5db; /* gray-300 */
}
.traversal-type-selector input[type="radio"], .bfs-dfs-type-selector input[type="radio"] { /* Combined */
    cursor: pointer;
    accent-color: #3b82f6; /* blue-500 */
}

/* Tree node container */
.tree-nodes-container {
    display: block; /* Changed from flex */
    position: relative; /* Crucial for absolute positioning of nodes */
    width: 100%;
    min-height: 180px; /* Adjust as needed */
    margin: 15px auto; /* Add some margin */
    overflow: auto; /* Allow scroll if tree is wide/tall */
    box-sizing: border-box;
}

/* Base Tree Node Style */
.tree-node {
    width: 35px; height: 35px; border-radius: 50%;
    display: flex; justify-content: center; align-items: center;
    font-weight: 500; font-size: 14px;
    border: 2px solid #9ca3af; /* Default border: gray-400 */
    background-color: #fff; /* Default background: white */
    color: #1f2937; /* Default text: gray-800 */
    position: absolute; /* For layout */
    transform: translateX(-50%); /* Center horizontally based on left % */
    z-index: 1;
    opacity: 1; /* Visible by default, JS controls hiding for BST/AVL */
    pointer-events: auto; /* Interactive by default */
    transition: all 0.3s ease-in-out; /* Combined transitions */
}
.dark .tree-node {
    border-color: #6b7280; background-color: #4b5563; color: #f3f4f6;
}

/* == Tree Traversal & BFS/DFS Highlighting States == */
.tree-node.visiting { /* General visiting/exploring */
    border-color: #fbbf24; /* amber-400 */
    transform: translateX(-50%) scale(1.1);
}
.dark .tree-node.visiting { border-color: #fcd34d; /* amber-300 */ }

.tree-node.processing { /* Node being actively processed */
    background-color: #60a5fa; /* blue-400 */ border-color: #3b82f6; /* blue-500 */ color: white;
    transform: translateX(-50%) scale(1.2);
}
.dark .tree-node.processing { background-color: #3b82f6; border-color: #2563eb; }

.tree-node.visited { /* Node fully processed/finished */
    opacity: 0.6; border-color: #d1d5db; /* gray-300 */
}
.dark .tree-node.visited { opacity: 0.5; border-color: #4b5563; }

.tree-node.queued { /* BFS specific */
    border-color: #6366f1; background-color: #e0e7ff;
}
.dark .tree-node.queued { border-color: #818cf8; background-color: #3730a3; }

.tree-node.stacked { /* Iterative DFS specific */
    border-color: #d946ef; background-color: #fae8ff;
}
.dark .tree-node.stacked { border-color: #e879f9; background-color: #701a75; }

/* == BST/AVL Insertion Highlighting States == */
.tree-node.comparing { /* Node being compared */
    border-color: #facc15; background-color: #fef9c3;
    transform: translateX(-50%) scale(1.1);
}
.dark .tree-node.comparing { border-color: #fde047; background-color: #422006; }

.tree-node.node-path { /* Node on the search path */
    border-color: #a855f7; background-color: #f3e8ff;
}
.dark .tree-node.node-path { border-color: #c084fc; background-color: #581c87; }

.tree-node.inserting { /* Node just inserted */
    background-color: #4ade80; border-color: #22c55e; color: white;
    transform: translateX(-50%) scale(1.2);
    opacity: 1 !important; /* Ensure visible when inserting */
    pointer-events: auto !important;
}
.dark .tree-node.inserting { background-color: #22c55e; border-color: #16a34a; }

/* == AVL Tree Specific Styles == */
.tree-node.imbalanced {
    border-color: #f87171; background-color: #fee2e2;
    transform: translateX(-50%) scale(1.15);
}
.dark .tree-node.imbalanced { border-color: #ef4444; background-color: #7f1d1d; }

.tree-node.rotating {
    border-color: #fb923c; box-shadow: 0 0 10px 2px #fb923c;
    transform: translateX(-50%) scale(1.1);
}
.dark .tree-node.rotating { border-color: #fdba74; box-shadow: 0 0 10px 2px #fdba74;}

/* Traversal/BFS/DFS result container */
.traversal-result-container, .bfs-dfs-result-container { /* Combined */
    margin-top: 5px; padding: 8px; border: 1px solid #e5e7eb; border-radius: 6px;
    background-color: #f9fafb; min-height: 30px; font-size: 0.875rem;
    text-align: center; color: #374151; width: 95%;
    display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 4px;
}
.dark .traversal-result-container, .dark .bfs-dfs-result-container { /* Combined */
    border-color: #4b5563; background-color: #374151; color: #d1d5db;
}
.traversal-result-container span:first-child, .bfs-dfs-result-container span:first-child { /* Combined */
    font-weight: 600; margin-right: 5px;
}
.traversal-result-container span:not(:first-child), .bfs-dfs-result-container span:not(:first-child) { /* Combined */
    padding: 2px 5px; background-color: #e5e7eb; border-radius: 3px;
    font-weight: 500; font-size: 0.8rem;
}
.dark .traversal-result-container span:not(:first-child), .dark .bfs-dfs-result-container span:not(:first-child) { /* Combined */
    background-color: #4b5563;
}


/* === Graph Visualization Specific Styles === */
#graph-svg-container {
    border: 1px solid #e5e7eb; /* gray-200 */
    border-radius: 6px;
    background-color: #f9fafb; /* gray-50 */
    display: block; margin: 0 auto; max-width: 100%;
}
.dark #graph-svg-container {
    border-color: #4b5563; background-color: #374151;
}

/* Arrowhead for directed graphs */
.graph-arrowhead {
    fill: #9ca3af; transition: fill 0.3s ease-in-out;
}
.dark .graph-arrowhead { fill: #6b7280; }

/* Default Edge Style */
.graph-edge {
    stroke: #9ca3af; stroke-width: 1.5;
    transition: stroke 0.3s ease-in-out, stroke-width 0.3s ease-in-out, stroke-dasharray 0.3s ease-in-out;
}
.dark .graph-edge { stroke: #6b7280; }

/* Edge Weight Label */
.graph-edge-weight {
    font-size: 10px; fill: #4b5563; font-weight: 500;
    pointer-events: none; user-select: none;
}
.dark .graph-edge-weight { fill: #d1d5db; }
.graph-edge-weight.negative-weight { fill: #dc2626; font-weight: 700; }
.dark .graph-edge-weight.negative-weight { fill: #f87171; }

/* Default Node Style */
.graph-node {
    fill: #fff; stroke: #6b7280; stroke-width: 2;
    transition: fill 0.3s ease-in-out, stroke 0.3s ease-in-out, transform 0.2s ease-in-out, opacity 0.3s ease-in-out;
    cursor: default;
}
.dark .graph-node { fill: #4b5563; stroke: #d1d5db; }

/* Node Label Style */
.graph-node-label {
    font-size: 11px; font-weight: 500; fill: #1f2937;
    pointer-events: none; user-select: none;
}
.dark .graph-node-label { fill: #f3f4f6; }

/* Node Distance Label (Dijkstra, Bellman-Ford) */
.graph-node-distance {
    font-size: 10px; fill: #1d4ed8; font-weight: 600;
    pointer-events: none; user-select: none;
}
.dark .graph-node-distance { fill: #93c5fd; }

/* --- Graph Node States --- */
.graph-node.initial { opacity: 0.8; }
.dark .graph-node.initial { opacity: 0.7; }
.graph-node.queued { /* BFS, Dijkstra PQ */
    fill: #bfdbfe; stroke: #3b82f6;
}
.dark .graph-node.queued { fill: #374151; stroke: #60a5fa; }
.graph-node.processing { /* BFS/DFS Active, Dijkstra Extract/Relax */
    fill: #fcd34d; stroke: #f59e0b; transform: scale(1.1);
}
.dark .graph-node.processing { fill: #78350f; stroke: #fcd34d; }
.graph-node.visited { /* BFS/DFS/Dijkstra Finalized */
    fill: #d1d5db; stroke: #9ca3af; opacity: 0.7;
}
.dark .graph-node.visited { fill: #374151; stroke: #6b7280; opacity: 0.6; }
.graph-node.updated { /* Bellman-Ford Relax */
    fill: #e0e7ff; stroke: #6366f1; transform: scale(1.1);
}
.dark .graph-node.updated { fill: #3730a3; stroke: #818cf8; }
.graph-node.final { /* Bellman-Ford Final (non-cycle) */
    fill: #d1d5db; stroke: #9ca3af; opacity: 0.9;
}
.dark .graph-node.final { fill: #374151; stroke: #6b7280; opacity: 0.8; }
.graph-node.negative-cycle { /* Bellman-Ford, Floyd-Warshall */
    fill: #fee2e2; stroke: #ef4444; transform: scale(1.15);
}
.dark .graph-node.negative-cycle { fill: #7f1d1d; stroke: #f87171; }


/* --- Graph Edge States --- */
.graph-edge.active { /* BFS/DFS Check */
    stroke: #fbbf24; stroke-width: 3;
}
.dark .graph-edge.active { stroke: #fcd34d; }
.graph-edge.checking { /* Dijkstra/Bellman-Ford Check */
    stroke: #f59e0b; stroke-width: 2.5;
}
.dark .graph-edge.checking { stroke: #fcd34d; }
.graph-edge.relaxed { /* Bellman-Ford Relax */
    stroke: #a855f7; stroke-width: 2.5;
}
.dark .graph-edge.relaxed { stroke: #c084fc; }
.graph-edge.path { /* Dijkstra/Bellman-Ford Final Path */
    stroke: #16a34a; stroke-width: 3;
}
.dark .graph-edge.path { stroke: #4ade80; }
.graph-edge.backtrack { /* DFS Backtrack */
    stroke: #a855f7; stroke-width: 2.5; stroke-dasharray: 4 2; opacity: 0.8;
}
.dark .graph-edge.backtrack { stroke: #c084fc; }
.graph-edge.negative-cycle { /* Bellman-Ford Cycle */
    stroke: #ef4444; stroke-width: 3; stroke-dasharray: 5 3;
}
.dark .graph-edge.negative-cycle { stroke: #f87171; }

/* Style arrowheads based on edge state */
.graph-edge.checking + polygon, line.checking ~ polygon,
.graph-edge.active + polygon, line.active ~ polygon { fill: #f59e0b; }
.dark .graph-edge.checking + polygon, .dark line.checking ~ polygon,
.dark .graph-edge.active + polygon, .dark line.active ~ polygon { fill: #fcd34d; }
.graph-edge.relaxed + polygon, line.relaxed ~ polygon { fill: #a855f7; }
.dark .graph-edge.relaxed + polygon, .dark line.relaxed ~ polygon { fill: #c084fc; }
.graph-edge.path + polygon, line.path ~ polygon { fill: #16a34a; }
.dark .graph-edge.path + polygon, .dark line.path ~ polygon { fill: #4ade80; }
.graph-edge.backtrack + polygon, line.backtrack ~ polygon { fill: #a855f7; }
.dark .graph-edge.backtrack + polygon, .dark line.backtrack ~ polygon { fill: #c084fc; }
.graph-edge.negative-cycle + polygon, line.negative-cycle ~ polygon { fill: #ef4444; }
.dark .graph-edge.negative-cycle + polygon, .dark line.negative-cycle ~ polygon { fill: #f87171; }


/* --- Graph Queue/Result/PQ/Distance Table Display --- */
.graph-queue-container, .graph-result-container,
.dijkstra-pq-container, .dijkstra-dist-table,
.bf-iteration-container, .bf-dist-table {
    padding: 8px 12px; border: 1px solid #e5e7eb; border-radius: 6px;
    background-color: #f9fafb; min-height: 40px; font-size: 0.875rem;
    color: #374151; flex: 1; overflow-x: auto;
}
.dark .graph-queue-container, .dark .graph-result-container,
.dark .dijkstra-pq-container, .dark .dijkstra-dist-table,
.dark .bf-iteration-container, .dark .bf-dist-table {
    border-color: #4b5563; background-color: #374151; color: #d1d5db;
}

.graph-queue-container, .graph-result-container,
.dijkstra-pq-container { /* Containers with inline items */
    display: flex; flex-wrap: wrap; align-items: center; gap: 6px;
}

.graph-queue-container span:first-child, .graph-result-container span:first-child,
.dijkstra-pq-container span:first-child, .dijkstra-dist-table span:first-child,
.bf-iteration-container span:first-child, .bf-dist-table span:first-child {
    font-weight: 600; /* Bold label */
    margin-right: 5px;
    white-space: nowrap;
}
/* Labels on their own line for tables/iteration */
.dijkstra-dist-table span:first-child,
.bf-iteration-container span:first-child,
.bf-dist-table span:first-child {
    display: block; margin-bottom: 4px;
}

/* Individual items in queue/result/pq */
.queue-item, .result-item, .pq-item {
    display: inline-flex; align-items: center; justify-content: center;
    min-width: 24px; height: 24px; padding: 0 6px;
    background-color: #e5e7eb; border: 1px solid #d1d5db; border-radius: 4px;
    font-weight: 500; font-size: 0.8rem; white-space: nowrap;
    margin-bottom: 4px; /* Spacing if wraps */
}
.dark .queue-item, .dark .result-item, .dark .pq-item {
    background-color: #4b5563; border-color: #6b7280;
}
.pq-item { background-color: #e0e7ff; border-color: #c7d2fe; } /* Dijkstra PQ */
.dark .pq-item { background-color: #3730a3; border-color: #4338ca; }

/* Distance Table Grid */
.dist-table-grid {
    display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
    gap: 4px 8px;
}
.dist-table-cell {
    font-size: 0.8rem; padding: 2px 4px; background-color: #e5e7eb;
    border-radius: 3px; text-align: center;
}
.dark .dist-table-cell { background-color: #4b5563; }
.dist-table-cell b { font-weight: 600; }


/* === Floyd-Warshall Specific Styles === */
.fw-matrix-container { margin-bottom: 1rem; }
.fw-matrix {
    border-collapse: collapse; margin: 0 auto; font-size: 0.8rem;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-radius: 4px; overflow: hidden;
}
.fw-matrix th, .fw-matrix td {
    border: 1px solid #d1d5db; padding: 4px 6px; text-align: center;
    min-width: 35px; height: 30px; transition: background-color 0.3s ease-in-out;
}
.dark .fw-matrix th, .dark .fw-matrix td { border-color: #4b5563; }
.fw-matrix-header { background-color: #f3f4f6; font-weight: 600; color: #374151; }
.dark .fw-matrix-header { background-color: #374151; color: #d1d5db; }
.fw-matrix-cell { background-color: #fff; color: #1f2937; font-family: monospace; }
.dark .fw-matrix-cell { background-color: #4b5563; color: #f3f4f6; }

/* FW Highlighting */
.fw-matrix-cell.highlight-k-row, .fw-matrix-cell.highlight-k-col { background-color: #fef3c7; }
.dark .fw-matrix-cell.highlight-k-row, .dark .fw-matrix-cell.highlight-k-col { background-color: #78350f; }
.fw-matrix-cell.highlight-ik, .fw-matrix-cell.highlight-kj {
    font-weight: bold; background-color: #fde68a; border: 1px solid #f59e0b;
}s
.dark .fw-matrix-cell.highlight-ik, .dark .fw-matrix-cell.highlight-kj { background-color: #b45309; border-color: #fcd34d; }
.fw-matrix-cell.highlight-ij { font-weight: bold; border: 2px solid #2563eb; box-shadow: inset 0 0 0 1px #2563eb; }
.dark .fw-matrix-cell.highlight-ij { border-color: #60a5fa; box-shadow: inset 0 0 0 1px #60a5fa; }
.fw-matrix-cell.updated {
    background-color: #a7f3d0; color: #047857; font-weight: bold; animation: pulse 0.6s ease-in-out;
}
.dark .fw-matrix-cell.updated { background-color: #065f46; color: #6ee7b7; }
.fw-matrix-cell.negative-cycle {
    background-color: #fecaca; color: #b91c1c; font-weight: bold; border: 2px solid #ef4444;
}
.dark .fw-matrix-cell.negative-cycle { background-color: #7f1d1d; color: #fca5a5; border-color: #f87171; }
.fw-iteration-container { padding: 4px 8px; border-radius: 4px; background-color: #e5e7eb; }
.dark .fw-iteration-container { background-color: #4b5563; }
.fw-iteration-container span { font-weight: 500; }

@keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.08); } 100% { transform: scale(1); } }

/* === Floyd-Warshall Graph Visualization Styles === */

/* Node Highlights */
.graph-node.intermediate-k {
    stroke: #f59e0b; /* amber-500 */
    stroke-width: 3;
    fill: #fef3c7; /* amber-100 */
}
.dark .graph-node.intermediate-k {
    stroke: #fcd34d; /* amber-300 */
    fill: #78350f; /* amber-900 */
}

.graph-node.source-i {
    stroke: #2563eb; /* blue-600 */
    stroke-width: 3;
    fill: #dbeafe; /* blue-100 */
}
.dark .graph-node.source-i {
    stroke: #60a5fa; /* blue-400 */
    fill: #1e3a8a; /* blue-900 */
}

.graph-node.dest-j {
    stroke: #16a34a; /* green-600 */
    stroke-width: 3;
    fill: #d1fae5; /* green-100 */
}
.dark .graph-node.dest-j {
    stroke: #4ade80; /* green-400 */
    fill: #064e3b; /* green-900 */
}

.graph-node.checking-neg-cycle {
     stroke: #ef4444; /* red-500 */
     stroke-width: 3;
     fill: #fee2e2; /* red-100 */
}
.dark .graph-node.checking-neg-cycle {
     stroke: #f87171; /* red-400 */
     fill: #7f1d1d; /* red-900 */
}


/* === Kruskal's MST Specific Styles === */

/* Node States */
.graph-node.checking { /* Node connected to edge being checked */
    stroke: #f59e0b; /* amber-500 */
    stroke-width: 3;
}
.dark .graph-node.checking {
    stroke: #fcd34d; /* amber-300 */
}

.graph-node.in-mst { /* Node part of the constructed MST */
    fill: #dcfce7; /* green-100 */
    stroke: #16a34a; /* green-600 */
}
.dark .graph-node.in-mst {
    fill: #052e16; /* green-950 */
    stroke: #4ade80; /* green-400 */
}

/* Edge States */
.graph-edge.checking { /* Edge being considered */
    stroke: #f59e0b; /* amber-500 */
    stroke-width: 3;
}
.dark .graph-edge.checking {
    stroke: #fcd34d; /* amber-300 */
}

.graph-edge.mst { /* Edge added to the MST */
    stroke: #16a34a; /* green-600 */
    stroke-width: 3.5; /* Make MST edges slightly thicker */
}
.dark .graph-edge.mst {
    stroke: #4ade80; /* green-400 */
}

.graph-edge.discarded { /* Edge that forms a cycle */
    stroke: #ef4444; /* red-500 */
    stroke-width: 1.5;
    stroke-dasharray: 4 4;
    opacity: 0.6;
}
.dark .graph-edge.discarded {
    stroke: #f87171; /* red-400 */
    opacity: 0.5;
}

/* --- Sorted Edge List and Cost Display --- */
.kruskal-edge-list, .kruskal-cost-container {
    padding: 8px 12px;
    border: 1px solid #e5e7eb; /* gray-200 */
    border-radius: 6px;
    background-color: #f9fafb; /* gray-50 */
    min-height: 40px;
    font-size: 0.875rem; /* 14px */
    color: #374151; /* gray-700 */
    flex: 1; /* Allow containers to share space */
}
.dark .kruskal-edge-list, .dark .kruskal-cost-container {
    border-color: #4b5563; /* gray-600 */
    background-color: #374151; /* gray-700 */
    color: #d1d5db; /* gray-300 */
}

.kruskal-edge-list span:first-child, .kruskal-cost-container span:first-child {
    font-weight: 600;
    display: block;
    margin-bottom: 4px;
}

.kruskal-edge-list .edge-items {
    max-height: 80px; /* Limit height and make scrollable */
    overflow-y: auto;
    padding-right: 5px; /* Space for scrollbar */
}

.kruskal-edge-item {
    display: block; /* Each edge on its own line */
    margin-bottom: 2px;
    padding: 2px 5px;
    border-radius: 3px;
    font-size: 0.8rem;
    white-space: nowrap;
    transition: background-color 0.3s ease-in-out, color 0.3s ease-in-out, border 0.3s ease-in-out;
    border: 1px solid transparent;
}

.kruskal-edge-item.checking {
    background-color: #fef3c7; /* amber-100 */
    border-color: #fde68a; /* amber-200 */
    font-weight: 500;
}
.dark .kruskal-edge-item.checking {
    background-color: #78350f; /* amber-900 */
    border-color: #b45309; /* amber-700 */
}

.kruskal-edge-item.mst {
    background-color: #dcfce7; /* green-100 */
    color: #065f46; /* green-800 */
    font-weight: 500;
}
.dark .kruskal-edge-item.mst {
    background-color: #052e16; /* green-950 */
    color: #86efac; /* green-300 */
}

.kruskal-edge-item.discarded {
    background-color: #fee2e2; /* red-100 */
    color: #991b1b; /* red-800 */
    text-decoration: line-through;
    opacity: 0.7;
}
.dark .kruskal-edge-item.discarded {
    background-color: #450a0a; /* red-950 */
    color: #fca5a5; /* red-300 */
     opacity: 0.6;
}

.kruskal-cost-container {
    text-align: center;
    font-size: 1rem;
    display: flex; /* Center content vertically */
    flex-direction: column;
    justify-content: center;
    min-width: 150px; /* Give cost container some minimum width */
    flex-grow: 0; /* Don't let it grow too much */
    flex-shrink: 0;
}
.kruskal-cost-container span {
    font-weight: bold;
}


/* === Prim's MST Specific Styles === */

/* Node Key Label */
.graph-node-key {
    font-size: 9px;
    fill: #4f46e5; /* indigo-600 */
    font-weight: 500;
    pointer-events: none;
    user-select: none;
}
.dark .graph-node-key {
    fill: #a5b4fc; /* indigo-300 */
}

/* Node States */
.graph-node.in-pq { /* Node whose key was updated, potentially in PQ */
    stroke: #ea580c; /* orange-600 */
    fill: #ffedd5; /* orange-100 */
}
.dark .graph-node.in-pq {
    stroke: #fb923c; /* orange-400 */
    fill: #7c2d12; /* orange-900 */
}

.graph-node.processing { /* Node just extracted from PQ */
    stroke: #d946ef; /* fuchsia-500 */
    fill: #fae8ff; /* fuchsia-100 */
    transform: scale(1.15);
}
.dark .graph-node.processing {
    stroke: #e879f9; /* fuchsia-400 */
    fill: #701a75; /* fuchsia-800 */
}

.graph-node.in-mst { /* Node finalized in MST */
    fill: #dcfce7; /* green-100 */
    stroke: #16a34a; /* green-600 */
}
.dark .graph-node.in-mst {
    fill: #052e16; /* green-950 */
    stroke: #4ade80; /* green-400 */
}

.graph-node.checking { /* Neighbor node being checked */
     stroke: #ca8a04; /* yellow-600 */
     /* fill: #fef9c3; */ /* yellow-100 - Optional fill */
     stroke-width: 2.5;
}
.dark .graph-node.checking {
     stroke: #facc15; /* yellow-400 */
     /* fill: #422006; */ /* yellow-950 */
}


/* Edge States */
.graph-edge.checking { /* Edge being checked from processing node */
    stroke: #f59e0b; /* amber-500 */
    stroke-width: 2.5;
}
.dark .graph-edge.checking {
    stroke: #fcd34d; /* amber-300 */
}

.graph-edge.candidate { /* Edge representing the current best key for a node */
    stroke: #6366f1; /* indigo-500 */
    stroke-width: 2;
    stroke-dasharray: 3 3;
    opacity: 0.8;
}
.dark .graph-edge.candidate {
    stroke: #818cf8; /* indigo-400 */
    opacity: 0.7;
}

.graph-edge.mst { /* Edge added to MST */
    stroke: #16a34a; /* green-600 */
    stroke-width: 3.5;
}
.dark .graph-edge.mst {
    stroke: #4ade80; /* green-400 */
}

/* --- Key/Parent Table and Cost Display --- */
.prim-keyparent-table, .prim-cost-container {
    padding: 8px 12px;
    border: 1px solid #e5e7eb; /* gray-200 */
    border-radius: 6px;
    background-color: #f9fafb; /* gray-50 */
    min-height: 40px;
    font-size: 0.875rem; /* 14px */
    color: #374151; /* gray-700 */
    flex: 1;
    overflow-x: auto;
}
.dark .prim-keyparent-table, .dark .prim-cost-container {
    border-color: #4b5563; /* gray-600 */
    background-color: #374151; /* gray-700 */
    color: #d1d5db; /* gray-300 */
}

.prim-keyparent-table span:first-child, .prim-cost-container span:first-child {
    font-weight: 600;
    display: block;
    margin-bottom: 4px;
}

.keyparent-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); /* Adjust minmax */
    gap: 4px 8px;
}

.keyparent-cell {
    font-size: 0.8rem;
    padding: 2px 4px;
    background-color: #e5e7eb; /* gray-200 */
    border-radius: 3px;
    text-align: center;
    border: 1px solid transparent; /* For highlighting */
    transition: background-color 0.3s ease-in-out, border-color 0.3s ease-in-out;
}
.dark .keyparent-cell {
    background-color: #4b5563; /* gray-600 */
}
.keyparent-cell b { font-weight: 600; }

/* Highlight cell corresponding to node state */
.keyparent-cell.processing { background-color: #fcd34d; border-color: #f59e0b;}
.dark .keyparent-cell.processing { background-color: #78350f; border-color: #fcd34d;}
.keyparent-cell.in-mst { background-color: #dcfce7; border-color: #16a34a;}
.dark .keyparent-cell.in-mst { background-color: #052e16; border-color: #4ade80;}
.keyparent-cell.in-pq { background-color: #ffedd5; border-color: #ea580c;}
.dark .keyparent-cell.in-pq { background-color: #7c2d12; border-color: #fb923c;}


.prim-cost-container { /* Reusing Kruskal style */
    text-align: center;
    font-size: 1rem;
    display: flex;
    flex-direction: column;
    justify-content: center;
    min-width: 150px;
    flex-grow: 0;
    flex-shrink: 0;
}
.prim-cost-container span { font-weight: bold; }



/* === Topological Sort Specific Styles (Update) === */

/* Node In-Degree Label */
.graph-node-indegree {
    font-size: 10px; /* Increased size */
    fill: #1d4ed8; /* Changed color to blue-700 for better visibility */
    font-weight: 600; /* Make it bolder */
    pointer-events: none;
    user-select: none;
    transition: fill 0.3s ease-in-out, transform 0.3s ease-in-out; /* Add transition */
}
.dark .graph-node-indegree {
    fill: #93c5fd; /* blue-300 */
}
.graph-node-indegree.indegree-updated {
    fill: #be123c; /* rose-700 */
    font-weight: 700;
    transform: scale(1.2); /* Slightly pulse size */
}
.dark .graph-node-indegree.indegree-updated {
    fill: #fda4af; /* rose-300 */
}


/* Node States (Keep existing styles) */
.graph-node.in-queue { /* ... */ }
.dark .graph-node.in-queue { /* ... */ }
.graph-node.processing { /* ... */ }
.dark .graph-node.processing { /* ... */ }
.graph-node.sorted { /* ... */ }
.dark .graph-node.sorted { /* ... */ }
.graph-node.cycle { /* ... */ }
.dark .graph-node.cycle { /* ... */ }


/* Edge States (Keep existing styles) */
.graph-edge.processing { /* ... */ }
.dark .graph-edge.processing { /* ... */ }
.graph-edge.processing + polygon, line.processing ~ polygon { /* ... */ }
.dark .graph-edge.processing + polygon, .dark line.processing ~ polygon { /* ... */ }


/* --- Queue and Result Display (Visual Update) --- */
.topo-queue-container, .topo-result-container {
    padding: 8px 12px;
    border: 1px solid #e5e7eb; /* gray-200 */
    border-radius: 6px;
    background-color: #f9fafb; /* gray-50 */
    min-height: 45px; /* Slightly taller */
    font-size: 0.875rem; /* 14px */
    color: #374151; /* gray-700 */
    flex: 1;
    overflow-x: auto;
    display: flex; /* Use flex for items */
    flex-wrap: wrap; /* Allow wrapping */
    align-items: center;
    gap: 6px; /* Gap between label and items, and between items */
}
.dark .topo-queue-container, .dark .topo-result-container {
    border-color: #4b5563; /* gray-600 */
    background-color: #374151; /* gray-700 */
    color: #d1d5db; /* gray-300 */
}

.topo-queue-container span:first-child, .topo-result-container span:first-child {
    font-weight: 600;
    margin-right: 5px;
    white-space: nowrap;
    align-self: flex-start; /* Align label to top if container wraps */
    padding-top: 4px; /* Align label better with boxes */
}

/* Common style for items in queue/result */
.topo-vis-item {
    display: inline-flex; align-items: center; justify-content: center;
    min-width: 28px; /* Slightly wider */
    height: 28px; /* Slightly taller */
    padding: 0 8px;
    border-radius: 4px;
    font-weight: 500;
    font-size: 0.85rem; /* Slightly larger font */
    font-family: monospace; /* Consistent width */
    border: 1px solid; /* Add border for definition */
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    transition: background-color 0.3s, border-color 0.3s, transform 0.2s;
}
.dark .topo-vis-item {
     box-shadow: none;
}

/* Specific styles for queue items */
.topo-queue-item {
    background-color: #e0e7ff; /* indigo-100 */
    border-color: #c7d2fe; /* indigo-200 */
    color: #3730a3; /* indigo-800 */
}
.dark .topo-queue-item {
    background-color: #3730a3; /* indigo-800 */
    border-color: #4338ca; /* indigo-700 */
    color: #e0e7ff; /* indigo-100 */
}

/* Specific styles for result items */
.topo-result-item {
    background-color: #d1fae5; /* green-100 */
    border-color: #a7f3d0; /* green-200 */
    color: #047857; /* green-700 */
}
.dark .topo-result-item {
    background-color: #064e3b; /* green-900 */
    border-color: #052e16; /* green-950 */
    color: #a7f3d0; /* green-300 */
}

/* Highlight newly added result item */
.topo-result-item.newly-added {
    transform: scale(1.1);
    border-color: #16a34a; /* green-600 */
}
.dark .topo-result-item.newly-added {
    border-color: #4ade80; /* green-400 */
}


/* Ensure other required styles (graph base, etc.) are present */








/* Edge Highlights */
.graph-edge.path-ik {
    stroke: #fbbf24; /* amber-400 */
    stroke-width: 2.5;
    stroke-dasharray: 5 3; /* Dashed for path component */
}
.dark .graph-edge.path-ik {
    stroke: #fcd34d; /* amber-300 */
}
.graph-edge.path-kj {
    stroke: #fbbf24; /* amber-400 */
    stroke-width: 2.5;
    stroke-dasharray: 5 3;
}
.dark .graph-edge.path-kj {
    stroke: #fcd34d; /* amber-300 */
}
.graph-edge.path-ij { /* Direct edge being compared */
    stroke: #6b7280; /* gray-500 */
    stroke-width: 2.5;
}
.dark .graph-edge.path-ij {
    stroke: #9ca3af; /* gray-400 */
}

.graph-edge.updated { /* Edge corresponding to matrix update */
    stroke: #10b981; /* emerald-500 */
    stroke-width: 3;
    animation: pulse-edge 0.6s ease-in-out;
}
.dark .graph-edge.updated {
    stroke: #6ee7b7; /* emerald-300 */
}

/* Final state for nodes when negative cycle exists */
.graph-node.final-neg-cycle {
    opacity: 0.5;
}
.dark .graph-node.final-neg-cycle {
     opacity: 0.4;
}


/* Reusing negative cycle styles from Bellman-Ford */
.graph-node.negative-cycle { /* Defined in Bellman-Ford styles */ }
.dark .graph-node.negative-cycle { /* Defined in Bellman-Ford styles */ }

/* Reusing final state style from Bellman-Ford */
.graph-node.final { /* Defined in Bellman-Ford styles */ }
.dark .graph-node.final { /* Defined in Bellman-Ford styles */ }


@keyframes pulse-edge {
  0% { stroke-width: 3; }
  50% { stroke-width: 4.5; }
  100% { stroke-width: 3; }
}

/* Ensure other required styles (matrix, graph base, etc.) are present */




/* === General UI === */
.dark pre { background-color: #1f2937; color: #d1d5db; }
.code-keyword { color: #ec4899; } .dark .code-keyword { color: #f9a8d4; }
.code-function { color: #8b5cf6; } .dark .code-function { color: #c4b5fd; }
.code-comment { color: #6b7280; } .dark .code-comment { color: #9ca3af; }
.code-number { color: #f59e0b; } .dark .code-number { color: #fcd34d; }
.code-string { color: #10b981; } .dark .code-string { color: #6ee7b7; }

details > summary { list-style: none; cursor: pointer; padding: 4px 0; }
details > summary::-webkit-details-marker { display: none; }
details > summary::before { content: '+'; display: inline-block; width: 1em; margin-right: 0.5em; font-weight: bold; transition: transform 0.2s ease-in-out; }
details[open] > summary::before { transform: rotate(45deg); }

.tab-btn.active { /* Styling handled by JS */ }
