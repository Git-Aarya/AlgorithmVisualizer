/* Apply Inter font globally */
body {
    font-family: 'Inter', sans-serif;
}

/* Custom scrollbar for sidebar (optional) */
.sidebar-scroll::-webkit-scrollbar { width: 6px; }
.sidebar-scroll::-webkit-scrollbar-track { background: transparent; }
.sidebar-scroll::-webkit-scrollbar-thumb { background-color: rgba(156, 163, 175, 0.5); border-radius: 3px; }
.dark .sidebar-scroll::-webkit-scrollbar-thumb { background-color: rgba(107, 114, 128, 0.5); }

/* === Visualization Bar Styling === */
.vis-bar {
    display: inline-block;
    background-color: #3b82f6; /* blue-500 */
    margin: 0 1px;
    width: 15px;
    vertical-align: bottom;
    transition: height 0.3s ease-in-out, background-color 0.3s ease-in-out, opacity 0.3s ease-in-out, border 0.1s ease-in-out, transform 0.3s ease-in-out;
    border-radius: 4px 4px 0 0;
    position: relative;
    text-align: center;
    color: white;
    font-size: 10px;
    line-height: 1;
    border: 1px solid transparent; /* Base border */
}
.dark .vis-bar { background-color: #60a5fa; /* blue-400 */ }

/* General comparison/mid-point highlight */
.vis-bar.comparing {
    background-color: #facc15; /* yellow-400 */
    border-color: #eab308; /* yellow-500 */
}
.dark .vis-bar.comparing {
    background-color: #fde047; /* yellow-300 */
    border-color: #facc15; /* yellow-400 */
}
/* Swapping highlight (Sorting) */
.vis-bar.swapping {
    background-color: #f87171; /* red-400 */
    border-color: #ef4444; /* red-500 */
}
.dark .vis-bar.swapping {
    background-color: #ef4444; /* red-500 */
    border-color: #dc2626; /* red-600 */
}
/* Sorted element highlight (General Sorting) */
 .vis-bar.sorted-pass { /* Used in Bubble sort pass */
    background-color: #a3e635; /* lime-400 */
 }
 .dark .vis-bar.sorted-pass { background-color: #bef264; /* lime-300 */ }
 .vis-bar.sorted-final { /* Final sorted state */
    background-color: #4ade80; /* green-400 */
 }
 .dark .vis-bar.sorted-final { background-color: #86efac; /* green-300 */ }

/* Found element highlight (Searching) */
.vis-bar.found {
    background-color: #fb923c; /* orange-400 */
    border: 2px solid #f97316; /* orange-500 */
}
.dark .vis-bar.found {
    background-color: #fdba74; /* orange-300 */
     border: 2px solid #ea580c; /* orange-600 */
}
 /* Dimmed/Checked/Out-of-range element */
.vis-bar.checked, .vis-bar.out-of-range, .vis-bar.outside-partition, .vis-bar.outside-heap-range, .vis-bar.outside-merge-range { opacity: 0.4; }
/* Highlight for the current search/partition range */
.vis-bar.in-range, .vis-bar.partition-range, .vis-bar.heap-range, .vis-bar.merge-range { /* No specific style, relies on dimming */ }

/* == Selection Sort Specific Styles == */
.vis-bar.current-outer { border-bottom: 3px solid #a855f7; } /* purple-500 */
.dark .vis-bar.current-outer { border-bottom-color: #c084fc; } /* purple-400 */
.vis-bar.minimum { background-color: #ec4899; border-color: #db2777; } /* pink-500/600 */
.dark .vis-bar.minimum { background-color: #f9a8d4; border-color: #ec4899; } /* pink-300/500 */

/* == Insertion Sort Specific Styles == */
.vis-bar.current-insertion { border: 2px solid #f43f5e; transform: translateY(-10px); } /* rose-500 */
.dark .vis-bar.current-insertion { border-color: #fb7185; } /* rose-400 */
.vis-bar.shifting { opacity: 0.7; background-color: #6366f1; } /* indigo-500 */
 .dark .vis-bar.shifting { background-color: #818cf8; } /* indigo-400 */

/* == Quick Sort Specific Styles == */
.vis-bar.pivot { border: 2px dashed #f43f5e; } /* rose-500 dashed border */
.dark .vis-bar.pivot { border-color: #fb7185; } /* rose-400 */
.vis-bar.partition-i::before { content: 'i'; position: absolute; top: -18px; left: 50%; transform: translateX(-50%); font-size: 12px; font-weight: bold; color: #a855f7; } /* purple-500 */
 .dark .vis-bar.partition-i::before { color: #c084fc; } /* purple-400 */
.vis-bar.partition-j::after { content: 'j'; position: absolute; bottom: -18px; left: 50%; transform: translateX(-50%); font-size: 12px; font-weight: bold; color: #22c55e; } /* green-500 */
.dark .vis-bar.partition-j::after { color: #4ade80; } /* green-400 */
.vis-bar.sorted-partition { background-color: #22d3ee; } /* cyan-400 */
.dark .vis-bar.sorted-partition { background-color: #67e8f9; } /* cyan-300 */

/* == Merge Sort Specific Styles == */
.vis-bar.placing-merge { background-color: #6366f1; border-color: #4f46e5; } /* indigo-500/600 */
 .dark .vis-bar.placing-merge { background-color: #818cf8; border-color: #6366f1; } /* indigo-400/500 */

/* == Heap Sort Specific Styles == */
.vis-bar.heapify-node { border: 2px solid #fbbf24; /* amber-400 */ }
.dark .vis-bar.heapify-node { border-color: #fcd34d; /* amber-300 */ }
.vis-bar.heapify-largest { background-color: #f87171; /* red-400 */ }
.dark .vis-bar.heapify-largest { background-color: #ef4444; /* red-500 */ }

/* === Counting Sort Specific Styles === */
.vis-bar.reading { background-color: #fb923c; } /* orange-400 */
.dark .vis-bar.reading { background-color: #fdba74; } /* orange-300 */
.vis-bar.writing { background-color: #a3e635; } /* lime-400 */
.dark .vis-bar.writing { background-color: #bef264; } /* lime-300 */

.count-array-vis, .output-array-vis {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    margin-top: 10px;
    padding: 8px;
    border: 1px solid #e5e7eb; /* gray-200 */
    border-radius: 6px;
    background-color: #f9fafb; /* gray-50 */
    min-height: 40px;
    align-items: center;
    position: relative; /* For label */
    padding-top: 14px; /* Space for label */
    margin-bottom: 20px; /* Space for indices */
}
.dark .count-array-vis, .dark .output-array-vis {
    border-color: #4b5563; /* gray-600 */
    background-color: #374151; /* gray-700 */
}
.count-array-vis::before, .output-array-vis::before {
    content: attr(data-label);
    position: absolute;
    top: -10px;
    left: 5px;
    font-size: 0.75rem; /* 12px */
    font-weight: 500;
    color: #6b7280; /* gray-500 */
    background-color: #f9fafb; /* gray-50 */
    padding: 0 4px;
}
.dark .count-array-vis::before, .dark .output-array-vis::before {
    color: #d1d5db; /* gray-300 */
    background-color: #374151; /* gray-700 */
}

.count-cell, .output-cell {
    min-width: 25px;
    height: 25px;
    border: 1px solid #d1d5db; /* gray-300 */
    border-radius: 4px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 11px;
    background-color: #fff; /* white */
    transition: background-color 0.3s ease-in-out, border-color 0.3s ease-in-out, transform 0.2s ease-in-out;
    position: relative; /* For index label */
    color: #1f2937; /* gray-800 */
}
.dark .count-cell, .dark .output-cell {
    border-color: #6b7280; /* gray-500 */
    background-color: #4b5563; /* gray-600 */
    color: #f3f4f6; /* gray-100 */
}
.count-cell::after, .output-cell::after {
    content: attr(data-index);
    position: absolute;
    bottom: -14px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 9px;
    color: #9ca3af; /* gray-400 */
}
.dark .count-cell::after, .dark .output-cell::after {
    color: #6b7280; /* gray-500 */
}

.count-cell.highlight-read, .output-cell.highlight-read {
    border-color: #fb923c; /* orange-400 */
    transform: scale(1.1);
}
.count-cell.highlight-write, .output-cell.highlight-write {
    background-color: #a3e635; /* lime-400 */
    border-color: #84cc16; /* lime-500 */
    transform: scale(1.1);
}
.dark .count-cell.highlight-write, .dark .output-cell.highlight-write {
     background-color: #bef264; /* lime-300 */
     border-color: #a3e635; /* lime-400 */
}
.output-cell.empty {
    background-color: #e5e7eb; /* gray-200 */
    color: #9ca3af; /* gray-400 */
}
.dark .output-cell.empty {
    background-color: #4b5563; /* gray-600 */
    color: #6b7280; /* gray-500 */
}


/* === Tree Visualization Specific Styles === */
.tree-visualization-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    padding: 15px;
    border: 1px solid #e5e7eb; /* gray-200 */
    border-radius: 6px;
    background-color: #f9fafb; /* gray-50 */
    margin-bottom: 10px;
    width: 100%;
    box-sizing: border-box;
}
.dark .tree-visualization-container {
    border-color: #4b5563; /* gray-600 */
    background-color: #374151; /* gray-700 */
}

/* Styles for Tree Traversal Type Selector */
.traversal-type-selector {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 15px;
    margin-bottom: 10px;
    padding: 5px;
    font-size: 0.875rem;
}
.traversal-type-selector label {
    display: flex;
    align-items: center;
    gap: 5px;
    cursor: pointer;
    color: #374151; /* gray-700 */
}
.dark .traversal-type-selector label {
    color: #d1d5db; /* gray-300 */
}
.traversal-type-selector input[type="radio"] {
    cursor: pointer;
    accent-color: #3b82f6; /* blue-500 */
}

/* Tree node container */
.tree-nodes-container {
    display: block;
    position: relative; /* Crucial for absolute children */
    width: 100%;
    min-height: 180px; /* Adjust as needed */
    margin-bottom: 15px auto;
    overflow-x: auto;   /* Allow horizontal scroll */
    overflow: auto; /* Allow vertical scroll if needed */
    box-sizing: border-box;
}

/* Base Tree Node Style - VISIBLE BY DEFAULT */
.tree-node {
    width: 35px; /* Fixed width */
    height: 35px; /* Fixed height */
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: 500;
    font-size: 14px;
    border: 2px solid #9ca3af; /* Default border: gray-400 */
    background-color: #fff; /* Default background: white */
    color: #1f2937; /* Default text: gray-800 */
    position: absolute; /* For layout */
    /* transform: translateX(-50%); */ /* REMOVED - Using pixel positioning now */
    z-index: 1;
    /* --- Visibility controlled by JS/opacity for BST/AVL --- */
    opacity: 1; /* VISIBLE by default */
    pointer-events: auto; /* INTERACTIVE by default */
    /* --- Transitions --- */
    transition: background-color 0.3s ease-in-out, border-color 0.3s ease-in-out, color 0.3s ease-in-out, transform 0.2s ease-in-out, opacity 0.3s ease-in-out, top 0.3s ease-in-out, left 0.3s ease-in-out;
}
.dark .tree-node {
    border-color: #6b7280; /* gray-500 */
    background-color: #4b5563; /* gray-600 */
    color: #f3f4f6; /* gray-100 */
}

/* == Tree Traversal Highlighting States == */
.tree-node.visiting {
    opacity: 1; pointer-events: auto; border-color: #fbbf24; /* amber-400 */
    transform: scale(1.1); /* Scale from top-left */
}
.dark .tree-node.visiting { border-color: #fcd34d; /* amber-300 */ }

.tree-node.processing { /* Used in Traversal */
    opacity: 1; pointer-events: auto; background-color: #60a5fa; /* blue-400 */ border-color: #3b82f6; /* blue-500 */ color: white;
    transform: scale(1.2); /* Scale from top-left */
}
.dark .tree-node.processing { background-color: #3b82f6; /* blue-500 */ border-color: #2563eb; /* blue-600 */ }

.tree-node.visited { /* Node fully processed in Traversal */
    opacity: 0.6; pointer-events: auto; border-color: #d1d5db; /* gray-300 */
    /* transform: scale(1.0); */ /* Reset scale */
}
.dark .tree-node.visited { opacity: 0.5; border-color: #4b5563; /* gray-600 */ }

/* == BST/AVL Insertion Highlighting States == */
.tree-node.comparing { /* Node being compared */
    opacity: 1; pointer-events: auto; border-color: #facc15; /* yellow-400 */ background-color: #fef9c3; /* yellow-100 */
    transform: scale(1.1); /* Scale from top-left */
}
.dark .tree-node.comparing { border-color: #fde047; /* yellow-300 */ background-color: #422006; }

.tree-node.node-path { /* Node on the search path */
    opacity: 1; pointer-events: auto; border-color: #a855f7; /* purple-500 */ background-color: #f3e8ff; /* purple-100 */
}
.dark .tree-node.node-path { border-color: #c084fc; /* purple-400 */ background-color: #581c87; /* purple-900 */ }

.tree-node.inserting { /* Node just inserted */
    opacity: 1; pointer-events: auto; background-color: #4ade80; /* green-400 */ border-color: #22c55e; /* green-500 */ color: white;
    transform: scale(1.2); /* Scale from top-left */
}
.dark .tree-node.inserting { background-color: #22c55e; /* green-500 */ border-color: #16a34a; /* green-600 */ }

/* == AVL Tree Specific Styles == */
.tree-node.imbalanced {
    opacity: 1; pointer-events: auto; border-color: #f87171; /* red-400 */ background-color: #fee2e2; /* red-100 */
    transform: scale(1.15); /* Scale from top-left */
}
.dark .tree-node.imbalanced { border-color: #ef4444; /* red-500 */ background-color: #7f1d1d; /* red-900 */ }

.tree-node.rotating {
    opacity: 1; pointer-events: auto; border-color: #fb923c; /* orange-400 */ box-shadow: 0 0 10px 2px #fb923c; /* Add glow */
    transform: scale(1.1); /* Scale from top-left */
}
.dark .tree-node.rotating { border-color: #fdba74; /* orange-300 */ box-shadow: 0 0 10px 2px #fdba74;}


/* Traversal result container */
.traversal-result-container {
    margin-top: 0; padding: 8px; border: 1px solid #e5e7eb; border-radius: 6px;
    background-color: #f9fafb; min-height: 30px; font-size: 0.875rem;
    text-align: center; color: #374151; width: 95%;
}
.dark .traversal-result-container { border-color: #4b5563; background-color: #374151; color: #d1d5db; }
.traversal-result-container span { margin: 0 4px; font-weight: 500; }



/* === BFS/DFS Tree Specific Styles === */

/* Style for nodes in the BFS queue */
.tree-node.queued {
    border-color: #6366f1; /* indigo-500 */
    background-color: #e0e7ff; /* indigo-100 */
}
.dark .tree-node.queued {
    border-color: #818cf8; /* indigo-400 */
    background-color: #3730a3; /* indigo-800 */
}

/* Style for nodes in the DFS stack (if using iterative DFS later) */
.tree-node.stacked {
    border-color: #d946ef; /* fuchsia-500 */
    background-color: #fae8ff; /* fuchsia-100 */
}
.dark .tree-node.stacked {
    border-color: #e879f9; /* fuchsia-400 */
    background-color: #701a75; /* fuchsia-800 */
}

/* --- Controls and Result Display --- */
.bfs-dfs-type-selector {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 15px;
    margin-bottom: 10px;
    padding: 5px;
    font-size: 0.875rem; /* 14px */
}
.bfs-dfs-type-selector label {
    display: flex;
    align-items: center;
    gap: 5px;
    cursor: pointer;
    color: #374151; /* gray-700 */
}
.dark .bfs-dfs-type-selector label {
    color: #d1d5db; /* gray-300 */
}
.bfs-dfs-type-selector input[type="radio"] {
    cursor: pointer;
    accent-color: #3b82f6; /* blue-500 */
}

.bfs-dfs-result-container {
    margin-top: 5px; /* Reduced margin */
    padding: 8px;
    border: 1px solid #e5e7eb; /* gray-200 */
    border-radius: 6px;
    background-color: #f9fafb; /* gray-50 */
    min-height: 30px;
    font-size: 0.875rem; /* 14px */
    text-align: center;
    color: #374151; /* gray-700 */
    width: 95%;
    display: flex; /* Use flex for alignment */
    flex-wrap: wrap; /* Allow wrapping */
    justify-content: center;
    align-items: center;
    gap: 4px; /* Space between label and numbers */
}
.dark .bfs-dfs-result-container {
    border-color: #4b5563; /* gray-600 */
    background-color: #374151; /* gray-700 */
    color: #d1d5db; /* gray-300 */
}
.bfs-dfs-result-container span:first-child {
    font-weight: 600; /* Make "BFS/DFS Result:" bold */
    margin-right: 5px;
}
.bfs-dfs-result-container span:not(:first-child) {
    padding: 2px 5px;
    background-color: #e5e7eb; /* gray-200 */
    border-radius: 3px;
    font-weight: 500;
    font-size: 0.8rem; /* Slightly smaller */
}
.dark .bfs-dfs-result-container span:not(:first-child) {
    background-color: #4b5563; /* gray-600 */
}



/* === General UI === */
.dark pre { background-color: #1f2937; color: #d1d5db; }
.code-keyword { color: #ec4899; } .dark .code-keyword { color: #f9a8d4; }
.code-function { color: #8b5cf6; } .dark .code-function { color: #c4b5fd; }
.code-comment { color: #6b7280; } .dark .code-comment { color: #9ca3af; }
.code-number { color: #f59e0b; } .dark .code-number { color: #fcd34d; }
.code-string { color: #10b981; } .dark .code-string { color: #6ee7b7; }

details > summary { list-style: none; cursor: pointer; padding: 4px 0; }
details > summary::-webkit-details-marker { display: none; }
details > summary::before { content: '+'; display: inline-block; width: 1em; margin-right: 0.5em; font-weight: bold; transition: transform 0.2s ease-in-out; }
details[open] > summary::before { transform: rotate(45deg); }

.tab-btn.active { /* Styling handled by JS */ }